# Dativo Talon — Default PII Recognizers (EU-focused)
# Format: Presidio-compatible recognizer YAML with Talon extensions (sensitivity, countries).
# See: https://microsoft.github.io/presidio/analyzer/adding_recognizers/

recognizers:
  - name: "Email Address"
    supported_entity: "EMAIL_ADDRESS"
    enabled: true
    patterns:
      - name: "standard email"
        regex: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
        score: 0.85
    supported_languages:
      - language: "en"
        context: ["email", "e-mail", "mail"]
    sensitivity: 1
    countries: ["EU"]

  - name: "Phone Number"
    supported_entity: "PHONE_NUMBER"
    enabled: true
    patterns:
      - name: "E.164 international"
        regex: '\+[1-9]\d{6,14}\b'
        score: 0.7
    supported_languages:
      - language: "en"
        context: ["phone", "tel", "call", "mobile", "fax"]
      - language: "de"
        context: ["telefon", "anruf", "handy", "mobil"]
    sensitivity: 1
    countries: ["EU"]

  - name: "IBAN"
    supported_entity: "IBAN_CODE"
    enabled: true
    patterns:
      - name: "IBAN standard"
        regex: '\b[A-Z]{2}\d{2}[A-Z0-9]{1,30}\b'
        score: 0.9
    supported_languages:
      - language: "en"
        context: ["iban", "bank account", "account number"]
    sensitivity: 3
    countries: ["EU"]
    validate_iban: true

  - name: "Credit Card"
    supported_entity: "CREDIT_CARD"
    enabled: true
    patterns:
      - name: "Visa/MC/Discover"
        regex: '\b(?:4\d{3}|5[1-5]\d{2}|6(?:011|5\d{2}))\d{12}\b'
        score: 0.9
    supported_languages:
      - language: "en"
        context: ["credit card", "card number", "visa", "mastercard"]
    sensitivity: 3
    countries: ["Global"]
    validate_luhn: true

  - name: "VAT Number"
    supported_entity: "EU_VAT_ID"
    enabled: true
    patterns:
      - name: "EU VAT format"
        regex: '\b(AT|BE|BG|CY|CZ|DE|DK|EE|EL|ES|FI|FR|HR|HU|IE|IT|LT|LU|LV|MT|NL|PL|PT|RO|SE|SI|SK)U?[0-9A-Z]{8,12}\b'
        score: 0.7
    supported_languages:
      - language: "en"
        context: ["vat", "tax id", "tax number", "ust"]
    sensitivity: 1
    countries: ["EU"]

  - name: "German SSN"
    supported_entity: "DE_SSN"
    enabled: true
    patterns:
      - name: "Sozialversicherungsnummer"
        regex: '\b\d{2}\s?\d{6}\s?[A-Z]\s?\d{3}\b'
        score: 0.6
    supported_languages:
      - language: "de"
        context: ["sozialversicherungsnummer", "svnr", "versicherungsnummer"]
    sensitivity: 3
    countries: ["DE"]

  - name: "UK National Insurance"
    supported_entity: "UK_NINO"
    enabled: true
    patterns:
      - name: "NI number"
        regex: '\b[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}[0-9]{6}[A-D]{1}\b'
        score: 0.7
    supported_languages:
      - language: "en"
        context: ["national insurance", "ni number", "nino"]
    sensitivity: 3
    countries: ["GB"]

  - name: "French INSEE"
    supported_entity: "FR_SSN"
    enabled: true
    patterns:
      - name: "INSEE number"
        regex: '\b[12]\d{2}(0[1-9]|1[0-2])\d{8}\b'
        score: 0.6
    supported_languages:
      - language: "fr"
        context: ["numéro de sécurité sociale", "insee", "nir"]
    sensitivity: 3
    countries: ["FR"]

  - name: "IP Address"
    supported_entity: "IP_ADDRESS"
    enabled: true
    patterns:
      - name: "IPv4"
        regex: '\b(?:\d{1,3}\.){3}\d{1,3}\b'
        score: 0.6
      - name: "IPv6"
        regex: '(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b'
        score: 0.6
    supported_languages:
      - language: "en"
        context: ["ip", "address", "server", "host"]
    sensitivity: 1
    countries: ["Global"]

  - name: "Passport Number"
    supported_entity: "PASSPORT"
    enabled: true
    patterns:
      - name: "generic EU passport"
        regex: '\b[A-Z]{1,2}\d{6,9}\b'
        score: 0.4
    supported_languages:
      - language: "en"
        context: ["passport", "travel document", "id number", "identity"]
      - language: "de"
        context: ["reisepass", "ausweis"]
      - language: "fr"
        context: ["passeport"]
      - language: "es"
        context: ["pasaporte"]
    sensitivity: 3
    countries: ["EU"]

  # --- Germany ---
  - name: "German Personalausweisnummer"
    supported_entity: "DE_ID_CARD"
    enabled: true
    patterns:
      - name: "Personalausweis 10-char"
        regex: '\b[CFGHJKLMNPRTVWXYZ0-9]{9}[0-9]\b'
        score: 0.7
    supported_languages:
      - language: "de"
        context: ["personalausweis", "ausweisnummer", "id card"]
    sensitivity: 3
    countries: ["DE"]

  - name: "German Steuer-ID"
    supported_entity: "DE_TAX_ID"
    enabled: true
    patterns:
      - name: "Steuer-ID 11 digits"
        regex: '\b\d{11}\b'
        score: 0.4
    supported_languages:
      - language: "de"
        context: ["steuer-id", "steueridentifikationsnummer", "tax id"]
    sensitivity: 2
    countries: ["DE"]

  # --- France ---
  - name: "French NIR"
    supported_entity: "FR_NIR"
    enabled: true
    patterns:
      - name: "NIR Securite sociale"
        regex: '\b[12]\d{2}(0[1-9]|1[0-2])(\d{2}|2[AB])\d{3}\d{3}\d{2}\b'
        score: 0.75
    supported_languages:
      - language: "fr"
        context: ["nir", "numéro de sécurité sociale", "sécurité sociale"]
    sensitivity: 3
    countries: ["FR"]

  - name: "French Carte d'identite"
    supported_entity: "FR_ID_CARD"
    enabled: true
    patterns:
      - name: "Carte identite 12 digits"
        regex: '\b\d{12}\b'
        score: 0.4
    supported_languages:
      - language: "fr"
        context: ["carte d'identité", "carte d identite", "identité"]
    sensitivity: 3
    countries: ["FR"]

  # --- Netherlands ---
  - name: "Dutch BSN"
    supported_entity: "NL_BSN"
    enabled: true
    patterns:
      - name: "BSN 9 digits"
        regex: '\b\d{9}\b'
        score: 0.7
    supported_languages:
      - language: "nl"
        context: ["bsn", "burgerservicenummer", "sofi"]
    sensitivity: 3
    countries: ["NL"]
    validate_bsn: true

  # --- Poland ---
  - name: "Polish PESEL"
    supported_entity: "PL_PESEL"
    enabled: true
    patterns:
      - name: "PESEL 11 digits"
        regex: '\b\d{11}\b'
        score: 0.4
    supported_languages:
      - language: "pl"
        context: ["pesel", "numer pesel", "dowód"]
    sensitivity: 3
    countries: ["PL"]
    validate_pesel: true

  - name: "Polish NIP"
    supported_entity: "PL_NIP"
    enabled: true
    patterns:
      - name: "NIP tax ID"
        regex: '\b\d{3}-?\d{3}-?\d{2}-?\d{2}\b'
        score: 0.4
    supported_languages:
      - language: "pl"
        context: ["nip", "numer nip", "tax id"]
    sensitivity: 2
    countries: ["PL"]

  # --- Spain ---
  - name: "Spanish DNI"
    supported_entity: "ES_DNI"
    enabled: true
    patterns:
      - name: "DNI 8 digits + letter"
        regex: '\b\d{8}[A-Z]\b'
        score: 0.8
    supported_languages:
      - language: "es"
        context: ["dni", "documento nacional", "identidad"]
    sensitivity: 3
    countries: ["ES"]

  - name: "Spanish NIE"
    supported_entity: "ES_NIE"
    enabled: true
    patterns:
      - name: "NIE X/Y/Z + 7 digits + letter"
        regex: '\b[XYZ]\d{7}[A-Z]\b'
        score: 0.8
    supported_languages:
      - language: "es"
        context: ["nie", "número de identidad de extranjero"]
    sensitivity: 3
    countries: ["ES"]

  # --- Belgium ---
  - name: "Belgian Rijksregisternummer"
    supported_entity: "BE_NATIONAL_ID"
    enabled: true
    patterns:
      - name: "Rijksregister with optional dots/dash"
        regex: '\b\d{2}\.?\d{2}\.?\d{2}-?\d{3}\.?\d{2}\b'
        score: 0.4
    supported_languages:
      - language: "nl"
        context: ["rijksregisternummer", "nationaal nummer"]
      - language: "fr"
        context: ["numéro de registre national", "rn"]
    sensitivity: 3
    countries: ["BE"]

  # --- Austria ---
  - name: "Austrian Sozialversicherungsnummer"
    supported_entity: "AT_SVN"
    enabled: true
    patterns:
      - name: "SVN 4+6 digits (NNNN DDMMYY)"
        regex: '\b\d{4}(0[1-9]|[12]\d|3[01])(0[1-9]|1[0-2])\d{2}\b'
        score: 0.6
    supported_languages:
      - language: "de"
        context: ["sozialversicherungsnummer", "svnr", "sv-nummer"]
    sensitivity: 3
    countries: ["AT"]

  # --- Telecom / eSIM (IMSI, ICCID, EID) ---
  - name: "IMSI"
    supported_entity: "IMSI"
    enabled: true
    patterns:
      - name: "IMSI 15 digits (EU MCC 2xx)"
        regex: '\b2\d{14}\b'
        score: 0.85
    supported_languages:
      - language: "en"
        context: ["imsi", "subscriber identity", "mobile subscriber"]
    sensitivity: 3
    countries: ["EU"]

  - name: "ICCID"
    supported_entity: "ICCID"
    enabled: true
    patterns:
      - name: "ICCID 19-20 digits (89 prefix)"
        regex: '\b89\d{17,18}\b'
        score: 0.9
    supported_languages:
      - language: "en"
        context: ["iccid", "sim card", "esim", "uicc"]
    sensitivity: 3
    countries: ["EU"]

  - name: "EID (eUICC identifier)"
    supported_entity: "EID"
    enabled: true
    patterns:
      - name: "EID 32 digits"
        regex: '\b\d{32}\b'
        score: 0.9
    supported_languages:
      - language: "en"
        context: ["eid", "euicc", "esim identifier"]
    sensitivity: 3
    countries: ["EU"]

  # --- Sweden ---
  - name: "Swedish Personnummer"
    supported_entity: "SE_PERSONNUMMER"
    enabled: true
    patterns:
      - name: "Personnummer 6+4 or 8+4"
        regex: '\b\d{6}-?\d{4}\b|\b\d{8}-?\d{4}\b'
        score: 0.4
    supported_languages:
      - language: "sv"
        context: ["personnummer", "personnr", "id number"]
    sensitivity: 3
    countries: ["SE"]

  # --- Denmark ---
  - name: "Danish CPR-nummer"
    supported_entity: "DK_CPR"
    enabled: true
    patterns:
      - name: "CPR 6+4 digits"
        regex: '\b\d{6}-?\d{4}\b'
        score: 0.4
    supported_languages:
      - language: "da"
        context: ["cpr", "cpr-nummer", "personnummer"]
    sensitivity: 3
    countries: ["DK"]

  # --- Ireland ---
  - name: "Irish PPS Number"
    supported_entity: "IE_PPS"
    enabled: true
    patterns:
      - name: "PPS 7 digits + 1-2 letters"
        regex: '\b\d{7}[A-Z]{1,2}\b'
        score: 0.75
    supported_languages:
      - language: "en"
        context: ["pps", "pps number", "personal public service"]
    sensitivity: 3
    countries: ["IE"]

  # --- Portugal ---
  - name: "Portuguese NIF"
    supported_entity: "PT_NIF"
    enabled: true
    patterns:
      - name: "NIF 9 digits"
        regex: '\b\d{9}\b'
        score: 0.4
    supported_languages:
      - language: "pt"
        context: ["nif", "número de identificação fiscal", "tax id"]
    sensitivity: 2
    countries: ["PT"]
