# OpenClaw + Talon primer — OpenAI only.
# One provider (OpenAI), one caller (openclaw-main). Talon governs every request before forwarding.

gateway:
  enabled: true
  listen_prefix: "/v1/proxy"
  mode: "enforce"

  providers:
    openai:
      enabled: true
      secret_name: "openai-api-key"
      base_url: "https://api.openai.com"
      allowed_models: ["gpt-4o", "gpt-4o-mini", "gpt-4-turbo"]

  callers:
    # api_key below is the CALLER TOKEN (what OpenClaw sends). Not TALON_SECRETS_KEY.
    # TALON_SECRETS_KEY encrypts the vault; this key only identifies the caller.
    - name: "openclaw-main"
      api_key: "talon-gw-openclaw-001"
      tenant_id: "default"
      team: "engineering"
      allowed_providers: ["openai"]
      policy_overrides:
        max_daily_cost: 25.00
        max_monthly_cost: 500.00
        pii_action: "redact"
        allowed_models: ["gpt-4o", "gpt-4o-mini", "gpt-4-turbo"]

  default_policy:
    default_pii_action: "warn"
    # warn = audit PII in evidence (recommended for LLM-generated content).
    # Escalate to "redact" or "block" for stricter environments.
    response_pii_action: "warn"
    max_daily_cost: 100.00
    max_monthly_cost: 2000.00
    require_caller_id: true
    log_prompts: true
    log_responses: false
    # Tool governance: strip dangerous tools from LLM requests before the model sees them.
    # "filter" (default) removes forbidden tools; "block" rejects the entire request.
    tool_policy_action: "filter"
    forbidden_tools:
      - "delete_*"
      - "admin_*"
      - "export_all_*"
      - "bulk_*"
      - "rm_*"
      - "drop_*"
    # Attachment scanning: scans base64-encoded files (PDF, TXT, CSV, HTML)
    # in LLM API requests for PII and prompt injection.
    attachment_policy:
      action: "warn"            # block | strip | warn | allow
      injection_action: "warn"  # block | strip | warn
      max_file_size_mb: 10

  rate_limits:
    global_requests_per_min: 300
    per_caller_requests_per_min: 60

  timeouts:
    connect_timeout: 10s
    request_timeout: 120s
    stream_idle_timeout: 60s

# Tool governance controls which tools the LLM is told about — before it ever
# tries to call one. forbidden_tools patterns (glob) are merged across
# default_policy, provider, and per-caller policy_overrides. allowed_tools on
# a caller act as a strict allowlist (only those tools pass through).
# See docs/guides/openclaw-integration.md for the full tool governance guide.
